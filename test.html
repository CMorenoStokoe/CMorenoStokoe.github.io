<html>

    <!--

    Test page
    ---------------
    
    Intended purpose:

    Testing DOM generating and editing functions. This DOM 
    and functions are intended for testing that functions
    work in their intended purpose by performing content 
    and existence checks which are printed to the console
    
    -->

<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/ff3502b087.js" crossorigin="anonymous"></script>
</head>

<body style="font-family: consolas;">

    <style>
        .created_class{border: 0.1pt solid rgb(150, 150, 150); padding: 20px;}
        .blue{font-size: 1.1em;}
    </style>

    <h1>Test page</h1>
    <p id="test_results" style="margin-bottom: 0px; background-color: red;">Testing failure. Check console.</p>
    <p id="test_log" style="color: white; background-color: black;"></p>


    <div class="row">
    
        <div class="col-4">
            <div class="card"  style="margin: 5px; height: 95%; width: 95%;">
                <div class=card-header>
                    <h4>Buttons</h4>
                </div>
                <div class=card-body>
                    <em style="color: rgb(2, 117, 216)" >Creating a button here: </em><div id="test_div_btns"></div>
                    <p id="test_messages" style="background-color: lightgrey; margin-top: 0px;"></p>
                </div>
            </div>
        </div>
        
        <div class="col-4">
            <div class="card"  style="margin: 5px; height: 95%; width: 95%;">
                <div class=card-header>
                    <h4>Progress bars</h4>
                </div>
                <div class=card-body>
                    <div id="shadowrealm" style="display: none">
                        <em style="color: rgb(2, 117, 216)" >HIDDEN Progress bar template (static html)</em>
                        <div class="progress" id="progress_bar_template" style="margin: 10px;" >
                            <div class="progress-bar" role="progressbar" aria-valuenow="70"
                            aria-valuemin="0" aria-valuemax="100" style="width:70%">
                            70%
                            </div>
                        </div>
                    </div>
                    <div id="test_div_progs">
                        <em style="color: rgb(2, 117, 216)" >Initialising a new progress bar (current value 10, bar range 0-10), and editing it (current value 10 --> 5), here: </em>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-4">
            <div class="card"  style="margin: 5px; height: 95%; width: 95%;">
                <div class=card-header>
                    <h4>Visibility</h4>
                </div>
                <div class=card-body>
                    <em style="color: rgb(2, 117, 216)" >Two boxes are made visible: </em>
                    <div id="test_hidden" style="background-color: rgb(2, 117, 216); color:white; padding: 5px; margin: 5px; border-radius: 2px; visibility: hidden;">visibility: visible</div>
                    <div id="test_none" style="background-color: rgb(2, 117, 216); color:white; padding: 5px; margin: 5px; border-radius: 2px; display: none;">display: block</div>
                </div>
            </div>
        </div>
    </div>

    <div id="test_divs_content">

        <div class="row">
        
            <div class="col-3">
                <div class="card"  style="margin: 5px; height: 95%; width: 95%;">
                    <div class=card-header>
                        <h4>Text content</h4>
                    </div>
                    <div class=card-body>
                        <em style="color: rgb(2, 117, 216)" >Adding 'test text' here: </em><div id="test_div_text"></div>
                    </div>
                </div>
            </div>

            <div class="col-3">
                <div class="card"  style="margin: 5px; height: 95%; width: 95%;">
                    <div class=card-header>
                        <h4>Number rounding</h4></div>
                    <div class=card-body>
                        <em style="color: rgb(2, 117, 216)" >>10 = 3SF, &lt;10 = 2SF (4DP max)</em><br>
                        <em style="color: " >10.136789325 --> </em><span id="test_div_round" style="background-color: lightgrey"></span><br>
                        <em style="color: rgb(2, 117, 216)" >Numbers can be returned as %</em><br>
                        <em style="color: " >0.0005706 --> </em><span id="test_div_roundPct" style="background-color: lightgrey"></span>
                    </div>
                </div>
            </div>

            <div class="col-3">
                <div class="card"  style="margin: 5px; height: 95%; width: 95%;">
                    <div class=card-header>
                        <h4>Html content</h4>
                    </div>
                    <div class=card-body>
                        <em style="color: rgb(2, 117, 216)" >Adding <pre><code>&lt;strong> html code &lt;strong></code></pre> here: </em><div id="test_div_html" style="background-color: lightgrey"></div>
                    </div>
                </div>
            </div>

            <div class="col-3">
                <div class="card"  style="margin: 5px; height: 95%; width: 95%;">
                    <div class=card-header>
                        <h4>Colors</h4>
                    </div>
                    <div class=card-body>
                        <em style="color: rgb(2, 117, 216);" >Adding white text on blue background here: </em><div id="test_div_colors" style="padding: 5px; margin: 5px; border-radius: 2px; ">white text on blue bg</div>
                    </div>
                </div>
            </div>

        </div>
        
        <div class="row">
        
            <div class="col-3">
                <div class="card"  style="margin: 5px; height: 95%; width: 95%;">
                    <div class=card-header>
                        <h4>Divisions</h4>
                    </div>
                    <div class=card-body id="test_div">
                        <em style="color: rgb(2, 117, 216)" > Adding div here: </em>
                    </div>
                </div>
            </div>

            <div class="col-3">
                <div class="card"  style="margin: 5px; height: 95%; width: 95%;">
                    <div class=card-header>
                        <h4>Paragraphs</h4>
                    </div>
                    <div class=card-body style="ghostwhite" id="test_p">
                        <em style="color: rgb(2, 117, 216)" >Adding p here: </em>
                    </div>
                </div>
            </div>
            
            <div class="col-3">
                <div class="card"  style="margin: 5px; height: 95%; width: 95%;">
                    <div class=card-header>
                        <h4>Font-awesome Icons</h4>
                    </div>
                    <div class=card-body style="ghostwhite">
                        <em style="color: rgb(2, 117, 216)" >Adding FA icon here: </em>
                        <div id="test_i"></div>
                    </div>
                </div>
            </div>

            <div class="col-3">
            </div>

        </div>
    </div>

</body>

<footer>

    <script src="edit-element.js"></script>
    <script src="create-element.js"></script>
    <script src="event-handling.js"></script>
    <script src="debug.js"></script>

    <script>

        // Create button
        btn='button'
        createButton(btn, 'button text', 'test_div_btns', className = 'btn btn-primary');

        // Assign event listener
        function test_function(){
            this.id = 'new_button_id';
           
            // Verify that button was updated with correct event listener object
            document.getElementById("test_messages").innerText = "Passed manual test (dom-methods.addEventListener)"
            document.getElementById("test_messages").style.backgroundColor = "lightgreen"
            validate([{name : '[dom-methods.] addEventListener (add event)', expected : '[object HTMLButtonElement]', actual : get('new_button_id')},])
        }
        addEventListener(btn, test_function);

        // Create progress bar
        progId='progress_clone'
        createProgress(progId, 'test_div_progs');

        // Initialise progress bar
        setProgress(progId, 10, {min:0,max:10});

        // Set progress bar
        setProgress(progId, 5);

        // Set div text
        setText('test_div_text', 'test text');
        setText('test_div_round', roundNum(10.136789325));
        setText('test_div_roundPct', roundNum(0.0005706, percent=true));

        // Color text
        color('test_div_colors', 'white');
        colorBackground('test_div_colors', 'rgb(2, 117, 216)');
        

        // Set div html
        setHTML('test_div_html', '<strong>test html</strong>');

        // Set element visibility & display
        setVisibility('test_hidden', 'visible');
        setDisplay('test_none', 'block');

        // Create div and p
        createDiv('created_div', 'test_div', className="created_class")
        createP('created_p', 'text here', 'test_p', className="created_class")
        
        // Return FA icon
        document.getElementById('test_i').innerHTML = faIcon('adjust', 'blue')


        // Test functions
        tests = validate([

            // Check button was created and has correct text and class information
            {name : '[create-element.] createButton (create element)', expected : '[object HTMLButtonElement]', actual : get(btn)},
            {name : '[create-element.] createButton (set text)', expected : 'button text', actual : get(btn, prop='innerHTML')},
            {name : '[create-element.] createButton (set class)', expected : 'btn btn-primary', actual : get(btn, prop='className')},

            // Check progress bar was created
            {name : '[create-element.] createProgress (create element)', expected : '[object HTMLDivElement]', actual : get(progId)},

            // Check progress bar was updated with correct value, min and max
            {name : '[dom-methods.] setProgress (set value)', expected : 5, actual : get(progId, prop='ariaValueNow', child=true)},
            {name : '[dom-methods.] setProgress (set min)', expected : 0, actual : get(progId, prop='ariaValueMin', child=true)},
            {name : '[dom-methods.] setProgress (set max)', expected : 10, actual : get(progId, prop='ariaValueMax', child=true)},

            // Check text was set correctly
            {name : '[dom-methods.] setText (set value)', expected : 'test text', actual : get('test_div_text', prop='textContent')},
            //Check that number was rounded correctly
            {name : '[dom-methods.] roundNum (rounding)', expected : '10.1', actual : get('test_div_round', prop='textContent')},
            {name : '[dom-methods.] roundNum (percent)', expected : '0.0006%', actual : get('test_div_roundPct', prop='textContent')},

            // Check that color was set
            {name : '[dom-methods.] color (color)', expected : 'white', actual : get('test_div_colors', prop=['style','color'])},
            
            // Check that background color was set
            {name : '[dom-methods.] colorBackground (bg color)', expected : 'rgb(2, 117, 216)', actual : get('test_div_colors', prop=['style','backgroundColor'])},

            // Check html was set correctly
            {name : '[dom-methods.] setHTML (set value)', expected : '<strong>test html</strong>', actual : get('test_div_html', prop='innerHTML')},

            // Check that visibility and display were set correctly
            {name : '[dom-methods.] setVisibility (set visibility)', expected : 'visible', actual : get('test_hidden', prop=['style','visibility'])},
            {name : '[dom-methods.] setDisplay (set display)', expected : 'block', actual : get('test_none', prop=['style','display'])},

            // Check that div was created correctly
            {name : '[create-element.] createDiv (create element)', expected : '[object HTMLDivElement]', actual : get('created_div')},
            {name : '[create-element.] createDiv (set class)', expected : 'created_class', actual : get('created_div', prop="className")},

            // Check that p was created correctly
            {name : '[create-element.] createP (create element)', expected : '[object HTMLParagraphElement]', actual : get('created_p')},
            {name : '[create-element.] createP (set class)', expected : 'created_class', actual : get('created_p', prop="className")},
            {name : '[create-element.] createP (set text)', expected : 'text here', actual : get('created_p', prop="innerText")},

            // Check that i was created correctly
            {name : '[create-element.] faIcon (return element type)', expected : 'I', actual : get('test_i', prop="tagName", child=true)},
            {name : '[create-element.] faIcon (set class)', expected : 'fas fa-adjust blue', actual : get('test_i', prop="className", child=true)},
        ])

        if (tests['failed'].length > 0) {
            totalTests = tests['failed'].length + tests['passed'].length
            document.getElementById("test_results").innerText = "Failing automatic tests. " + tests['failed'].length + "/" + totalTests + " tests failed."
            document.getElementById("test_log").innerHTML = "<strong>Log:</strong> <br>" + tests['failed'];
            document.getElementById("test_results").style.backgroundColor = 'lightcoral';
        } else {
            document.getElementById("test_results").innerText = "Passing automatic tests (" + tests['passed'].length + "/" + tests['passed'].length + ")";
            document.getElementById("test_results").style.backgroundColor = 'lightgreen';
            document.getElementById("test_messages").innerText = "Manual test: Click the button to test dom-methods.addEventListener."
        }
        
    </script>

</footer>

</html>